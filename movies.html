<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elijah Soria -- Movie Ratings</title>
<link rel="icon" type="image/png" href="gd_favi.ico">
<style>
#header{
	padding:10px
}
body {
   background-color: black;
   color: white;
   font-size: 23px;
   line-height: 1.5;
}
/* unvisited link */
a:link {
  color: #91add4;
}
/* visited link */
a:visited {
  color: #829bbe;
}
/* mouse over link */
a:hover {
  color: #a7bddc;
}
/* selected link */
a:active {
  color: #829bbe;
}
.table-container {
   width: 540px;
}
.elijahimage {
  height: auto;
  width: 200px;
}
.menu {
  text-align: center;
  padding: 20px 0;
}
.r {
   display: flex;
   width: 100%;
   justify-content: space-between;
   align-items: center;
}
.c {
  padding: 15px 10px;
  text-align: left;
}
@media (max-width: 635px) {
  .table-container {
   width: 85vw;
  }
}
</style>
</head>
<body>
<div id="header"></div>
<center>
<div class="table-container">
   <div class="r menu">
	<a href="./index.html">Home</a>
	<a href="https://www.linkedin.com/in/elijah-soria-a63859a4/">LinkedIn</a>
        <a href="https://github.com/elijahsoria">Github</a>
        <a href="ElijahSoriaResume.pdf">Resume</a>
   </div>
   <h2>Elijah's Movie Reviews<br/>⭐⭐⭐⭐⭐</h2>
   <select id="sort_by" onChange="sortBy()">
    <option value="default" selected>Default</option>
    <option value="title">Movie Title (A->Z)</option>
    <option value="high_rated">Highest Rated</option>
    <option value="low_rated">Lowest Rated</option>
   </select>
   <div id="movie-list"></div>
	<script>
let mvlist = [];
function createMovieList() {
    fetch("./movies.txt")
   	.then( r => r.text() )
   	.then( text => {
    		let mvs = text.split("\n");
    		for (let i = 0; i < mvs.length - 1; i++) {
			let mv = mvs[i].split(";");
			mvlist.push([mv[0], mv[1]]);
    		}
    	});
};
await createMovieList();
		
function updateMovieEl(mvs) {
	let listdiv = document.getElementById('movie-list');
	listdiv.innerHTML = "";
	for (let i = 0; i < mvs.length; i++) {
			let mv = mvs[i];
			let mvDiv = document.createElement("div");
			mvDiv.classList.add("r");
			let name = document.createElement("div");
			name.innerHTML = mv[0];
			name.classList.add("c");
			let rtg = document.createElement("div"); 
			rtg.innerHTML = mv[1];
			rtg.classList.add("c");
			mvDiv.appendChild(name);
			mvDiv.appendChild(rtg);
			listdiv.appendChild(mvDiv);
    		}
};
updateMovieEl(mvlist);

function sortBy() {
var menu = document.getElementById("sort_by");
menu.addEventListener("change", sortMovies);
function sortMovies(event) {
  if (menu.value == 'title') {
    updateMovieEl(mvlist.sort((a,b) => a[0] <= b[0]));
  } else if (menu.value == 'high_rated') {
    updateMovieEl(mvlist.sort((a,b) => {
	    if (a[1] == b[1]) {
		    return a[0] <= b[0];
	    } else {
		    return a[1] > b[1];
	    }
    }));
  } else if (menu.value == 'low_rated') {
    updateMovieEl(mvlist.sort((a,b) => {
	    if (a[1] == b[1]) {
		    return a[0] <= b[0];
	    } else {
		    return a[1] < b[1];
	    }
    }));
  }
}
}
</script>
</div>
</center>
</body>
</html>
